# Example: Managed GarageNode with storage spec (Manual mode)
# Each GarageNode creates its own StatefulSet with replica 1
apiVersion: garage.rajsingh.info/v1alpha1
kind: GarageNode
metadata:
  labels:
    app.kubernetes.io/name: garage-operator
    app.kubernetes.io/managed-by: kustomize
  name: garage-node-0
  namespace: garage-operator-system
spec:
  clusterRef:
    name: garage

  # Zone assignment for fault tolerance
  zone: zone-a

  # Storage capacity for layout
  capacity: 100Gi

  # Storage configuration for managed nodes
  storage:
    metadata:
      size: 10Gi
    data:
      size: 100Gi
---
apiVersion: garage.rajsingh.info/v1alpha1
kind: GarageNode
metadata:
  name: garage-node-1
  namespace: garage-operator-system
spec:
  clusterRef:
    name: garage
  zone: zone-b
  capacity: 100Gi
  storage:
    metadata:
      size: 10Gi
    data:
      size: 100Gi
---
apiVersion: garage.rajsingh.info/v1alpha1
kind: GarageNode
metadata:
  name: garage-node-2
  namespace: garage-operator-system
spec:
  clusterRef:
    name: garage
  zone: zone-c
  capacity: 100Gi
  storage:
    metadata:
      size: 10Gi
      storageClassName: fast-ssd  # Example: custom storage class
    data:
      size: 100Gi
      storageClassName: fast-ssd
---
# Gateway node (no storage, no data PVC)
apiVersion: garage.rajsingh.info/v1alpha1
kind: GarageNode
metadata:
  name: garage-gateway
  namespace: garage-operator-system
spec:
  clusterRef:
    name: garage
  zone: gateway
  gateway: true
  storage:
    metadata:
      size: 1Gi  # Minimal metadata for node identity
---
# External node (multi-cluster federation, no StatefulSet created)
apiVersion: garage.rajsingh.info/v1alpha1
kind: GarageNode
metadata:
  name: external-dc2-node
  namespace: garage-operator-system
spec:
  clusterRef:
    name: garage

  # Specify node ID directly for external nodes
  nodeId: "563e1ac825ee3323aa441e72c26d1030d6d4414aeb3dd25287c531e7fc2bc95d"

  zone: dc2
  capacity: 1Ti

  external:
    address: garage-dc2.example.com
    port: 3901
